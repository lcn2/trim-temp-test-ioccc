<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- START: two lines up starts content from: inc/top.default.html -->
<!-- -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- -->
<!-- END: this line ends content from: inc/top.default.html -->
<!-- -->
<!-- The original markdown content was formed by the tool: bin/readme2index.sh -->
<!-- The HTML was converted from markdown by the tool: bin/md2html.sh -->
<!-- -->
<!-- START: this line starts content from: inc/head.default.html -->

<head>
<link rel="stylesheet" href="../../ioccc.css">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2013/mills - Most timely rendered</title>
<meta name="description" content="2013 IOCCC entry mills - Most timely rendered">
<meta name="keywords" content="IOCCC, 2013, IOCCC 2013, IOCCC entry, mills, Most timely rendered">
</head>

<!-- END: this line ends content from: inc/head.default.html -->
<!-- START: this line starts content from: inc/body.default.html -->

<body>

<!-- END: this line ends content from: inc/body.default.html -->
<!-- START: this line starts content from: inc/header.default.html -->

<div class="header">
  <img src="../../png/ioccc.png" alt="IOCCC image by Matt Zucker" width=300 height=110>
  <h1>The International Obfuscated C Code Contest</h1>
  <h2>2013/mills - Most timely rendered</h2>
</div>

<!-- END: this line ends content from: inc/header.default.html -->
<!-- START: this line starts content from: inc/topnav.mid.html -->

<div class="topnav">
  <a class="Left" href="../hou/index.html">&larr; hou</a>
  <a class="Left" href="../index.html">&uarr; 2013 &uarr;</a>
  <a class="Left" href="../misaka/index.html">misaka &rarr;</a>
  <a class="Right" href="#inventory">Inventory</a>
</div>

<!-- END: this line ends content from: inc/topnav.mid.html -->
<!-- START: this line starts content from: inc/begin-row.default.html -->

<div class="row">

<!-- END: this line ends content from: inc/begin-row.default.html -->
<!-- START: this line starts content from: inc/begin-leftcolumn.default.html -->

  <div class="leftcolumn">

<!-- END: this line ends content from: inc/begin-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/sidenav.default.html -->

    <div class="sidenav">
      <a href="#content">Jump to contents</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../index.html">IOCCC Home</a>
      <a href="../../years.html">Winning Entries</a>
      <a href="../../authors.html">People who have won</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../news.html">IOCCC News</a>
      <a href="../../faq.html#submit">How to enter the IOCCC</a>
      <a href="../../faq.html">FAQ</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../bugs.html">Bugs &amp; (mis)features</a>
      <a href="../../faq.html#fix_an_entry">Fixing IOCCC entries</a>
      <a href="../../faq.html#fix_web_site">Fixing the web site</a>
      <a href="../../faq.html#fix_author">Fixing author info</a>
      <a href="../../thanks-for-help.html">Thanks for the help</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../judges.html">The IOCCC Judges</a>
      <a href="../../contact.html">Contacting the IOCCC</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="#top">Jump to top</a>
    </div>

<!-- END: this line ends content from: inc/sidenav.default.html -->
<!-- START: this line starts content from: inc/end-leftcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/begin-rightcolumn.default.html -->

  <div class="rightcolumn">

<!-- END: this line ends content from: inc/begin-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/before-content.default.html -->

    <a name="content"></a>

<!-- END: this line ends content from: inc/before-content.default.html -->
<!-- START: this line starts content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-author.sh -->

<h2 id="author"><a name="author"></a>Author:</h2>
<ul>
<li>Name: <a href="../../authors.html#Christopher_Mills">Christopher
Mills</a><br> Location: <a href="../../location.html#US">US</a>
<br><br></li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-author.sh -->

<!-- END: this line ends content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->

<h2 id="to-build">To build:</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span></span></code></pre></div>
<h3 id="bugs-and-misfeatures">Bugs and (Mis)features:</h3>
<p>The current status of this entry is:</p>
<pre><code>STATUS: INABIAF - please **DO NOT** fix</code></pre>
<p>For more detailed information see <a href="/bugs.md#2013-mills">2013
mills in bugs.md</a>.</p>
<h2 id="to-use">To use:</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./mills</span></span></code></pre></div>
<h2 id="try">Try:</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./mills</span> <span class="kw">&amp;</span></span></code></pre></div>
<p>While that is running, point your favorite browser at: <a
href="http://localhost:8224">http://localhost:8224</a>.</p>
<h2 id="judges-remarks">Judges’ remarks:</h2>
<p>Who will be the first to post an image rendered during a
leap-second?</p>
<h2 id="authors-remarks">Author’s remarks:</h2>
<h3 id="the-program">The Program</h3>
<p>This program is a handy graphical clock. Simply run the program,
click <em>OK</em> to any annoying security dialog that pop up (aren’t
those annoying?), then fire up your web browser and type in the
following URL: <a href="http://localhost:8224"
class="uri">http://localhost:8224</a>.</p>
<p>You will soon be presented with a lovely dynamically rendered 3D
scene that also conveniently tells you the current time!</p>
<h3 id="usage-notes">Usage Notes</h3>
<p>The program will continue to give you the time of day as it changes
by reloading the page as often as it can render. If you grow tired of
watching your life slip by, hit <code>Control-C</code> in the original
window. Note that if you want to restart the program again, you should
wait a minute or two before doing so. For details as to why this is
necessary, feel free to Google <code>"TIME_WAIT"</code>,
<code>"SO_REUSEADDR"</code> and <code>"SO_REUSEPORT"</code> (with the
quotes). And while you are there, click on an ad. They could use the
money.</p>
<p>It would be possible to fix this by adding</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span><span class="dv">1</span><span class="op">,</span>setsockopt<span class="op">(</span>s<span class="op">,</span>SOL_SOCKET<span class="op">,</span>SO_REUSEADDR<span class="op">,&amp;</span>n<span class="op">,</span><span class="kw">sizeof</span> n<span class="op">),</span></span></code></pre></div>
<p>at an appropriate spot in the code (an exercise left to the reader).
However, as this limitation is documented, it is not technically a
bug.</p>
<h3 id="details-of-operation">Details of Operation</h3>
<p>The program wears many hats (not literally). It is</p>
<ul>
<li>a web server</li>
<li>a PNG encoder</li>
<li>a ray tracer</li>
<li>a clock</li>
</ul>
<p>It replies to web requests with a PNG image that uses the <a
href="http://en.wikipedia.org/wiki/Adam7_algorithm">Adam7</a> encoding
to return data progressively. Since the data is returned in Adam7
format, the scene is displayed initially at a lower resolution and
allowed to be progressively refined as time goes on. The ray tracer is
integrally tied to the PNG encoder, casting rays in the Adam7 order. The
web server uses PNG primarily because of PNG’s ability to return data
progressively, and not as you might think it being because the PNG
standard is so obfuscated as to require both little and big-endian
encodings at different spec layers.</p>
<p>Since ray-tracing was an obvious choice to return to a web server, I
needed something to ray-trace. A static scene would be uninteresting. I
took inspiration (as I often do) from the IOCCC remarks file which
says</p>
<blockquote>
<p>At least one judge prefers to maintain the use of the leap-second as
part of the world’s time standard.</p>
</blockquote>
<p>Then it was obvious; the code should display the time. It is believed
(but not confirmed) that the code will, in fact, display leap seconds
correctly.</p>
<p>To display the time, of course we would need a font. This font is
encoded as a string, using only the C whitespace characters. Clearly,
the judges intended this use of whitespace for data compression, since
their tool doesn’t count whitespace in strings differently than
whitespace outside of them.</p>
<h3 id="user-modifiable-features">User-modifiable Features</h3>
<p>The code can be user-modified simply by changing the build command
line. The following symbols are defined in the <a
href="Makefile">Makefile</a>:</p>
<ul>
<li><p><code>-DLT=x1,y1,z1,x2,y2,z2,...</code> defines the coordinates
of the lights in the scene. It should be a comma-separated list of
coordinates <code>(x, y, z)</code>, three per light.</p></li>
<li><p><code>-DNL=n</code> defines the number of lights. It should be
equal to the length of the list above (three times the number of
lights).</p></li>
<li><p><code>-DEY=x,y,z</code> defines the position of the viewer (the
eye point) for the scene. The eye is looking at the origin
<code>(0, 0, 0)</code>.</p></li>
</ul>
<h3 id="other-build-flags">Other Build Flags</h3>
<p>The original program bound the server to <code>INADDR_ANY</code> to
allow everyone to experience the server’s output. The Judges suggested
that I instead restrict the bind to <code>INADDR_LOOPBACK</code> to
reduce security alarms. As a compliant veteran of innumerable post-ship
late feature additions, I have modified the <a
href="Makefile">Makefile</a> to inject the new code without destroying
the beautiful spherical symmetry of the source code. In addition, I have
altered the word <code>sin_port</code> to the more family-friendly
version <code>win_port</code> (via
<code>-Dwin_port="sin_addr.s_addr=htonl(2130706433),R.sin_port"</code>)
to protect against curious impressionable youth trying to learn about
sockets on the Internet.</p>
<h2 id="copyright-and-cc-by-sa-4.0-license">Copyright and CC BY-SA 4.0
License:</h2>
<p>This file is Copyright (c) 2023 by Landon Curt Noll. All Rights
Reserved. You are free to share and adapt this file under the terms of
this license:</p>
<pre><code>Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)</code></pre>
<p>For more information, see:
https://creativecommons.org/licenses/by-sa/4.0/</p>

<!-- END: this line ends content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-inventory.sh -->

<h1 id="inventory-for-2013mills"><a name="inventory"></a>Inventory for
2013/mills</h1>
<h2 id="primary-files">Primary files</h2>
<ul>
<li><a href="index.html">index.html</a> - entry home page</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/mills.c">mills.c</a>
- winning source</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/Makefile">Makefile</a>
- entry Makefile</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/mills.orig.c">mills.orig.c</a>
- original source</li>
<li><a href="2013_mills.tar.bz2">2013_mills.tar.bz2</a> - download
winning source</li>
</ul>
<h2 id="secondary-files">Secondary files</h2>
<ul>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/.entry.json">.entry.json</a>
- description of entry in JSON</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/.gitignore">.gitignore</a>
- list of files that should not be committed under git</li>
<li><a href=".path">.path</a> - directory path from top directory</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2013/mills/README.md">README.md</a>
- markdown source for index.html</li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-inventory.sh -->

<!-- END: this line ends content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->
<!-- START: this line starts content from: inc/after-content.default.html -->

<!-- END: this line ends content from: inc/after-content.default.html -->
<!-- START: this line starts content from: inc/end-rightcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/end-row.default.html -->

</div>

<!-- END: this line ends content from: inc/end-row.default.html -->
<!-- START: this line starts content from: inc/footer.default.html -->

<div class="footer">
  <hr>
  <h2>Coda</h2>
  <p><a href="https://validator.w3.org/nu/?doc=https%3A%2F%2Fioccc-src.github.io%2Ftemp-test-ioccc%2F2013%2Fmills%2Findex.html">Nu HTML check this web page</a></p>
  <p><a href="#top">Jump to top</a> <a href="#content">Jump to Content</a> <a href="#inventory">Jump to Inventory</a></p>
</div>

<!-- END: this line ends content from: inc/footer.default.html -->
<!-- START: this line starts content from: inc/bottom.default.html -->

</body>
</html>

<!-- END: this line ends content from: inc/bottom.default.html -->
