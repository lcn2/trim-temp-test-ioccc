<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- START: two lines up starts content from: inc/top.default.html -->
<!-- -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- -->
<!-- END: this line ends content from: inc/top.default.html -->
<!-- -->
<!-- The original markdown content was formed by the tool: bin/readme2index.sh -->
<!-- The HTML was converted from markdown by the tool: bin/md2html.sh -->
<!-- -->
<!-- START: this line starts content from: inc/head.default.html -->

<head>
<link rel="stylesheet" href="../../ioccc.css">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2018/ciura - Most likely to be awarded</title>
<meta name="description" content="2018 IOCCC entry ciura - Most likely to be awarded">
<meta name="keywords" content="IOCCC, 2018, IOCCC 2018, IOCCC entry, ciura, Most likely to be awarded">
</head>

<!-- END: this line ends content from: inc/head.default.html -->
<!-- START: this line starts content from: inc/body.default.html -->

<body>

<!-- END: this line ends content from: inc/body.default.html -->
<!-- START: this line starts content from: inc/header.default.html -->

<div class="header">
  <img src="../../png/ioccc.png" alt="IOCCC image by Matt Zucker" width=300 height=110>
  <h1>The International Obfuscated C Code Contest</h1>
  <h2>2018/ciura - Most likely to be awarded</h2>
</div>

<!-- END: this line ends content from: inc/header.default.html -->
<!-- START: this line starts content from: inc/topnav.mid.html -->

<div class="topnav">
  <a class="Left" href="../burton2/index.html">&larr; burton2</a>
  <a class="Left" href="../index.html">&uarr; 2018 &uarr;</a>
  <a class="Left" href="../endoh1/index.html">endoh1 &rarr;</a>
  <a class="Right" href="#inventory">Inventory</a>
</div>

<!-- END: this line ends content from: inc/topnav.mid.html -->
<!-- START: this line starts content from: inc/begin-row.default.html -->

<div class="row">

<!-- END: this line ends content from: inc/begin-row.default.html -->
<!-- START: this line starts content from: inc/begin-leftcolumn.default.html -->

  <div class="leftcolumn">

<!-- END: this line ends content from: inc/begin-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/sidenav.default.html -->

    <div class="sidenav">
      <a href="#content">Jump to contents</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../index.html">IOCCC Home</a>
      <a href="../../years.html">Winning Entries</a>
      <a href="../../authors.html">People who have won</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../news.html">IOCCC News</a>
      <a href="../../faq.html#submit">How to enter the IOCCC</a>
      <a href="../../faq.html">FAQ</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../bugs.html">Bugs &amp; (mis)features</a>
      <a href="../../faq.html#fix_an_entry">Fixing IOCCC entries</a>
      <a href="../../faq.html#fix_web_site">Fixing the web site</a>
      <a href="../../faq.html#fix_author">Fixing author info</a>
      <a href="../../thanks-for-help.html">Thanks for the help</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../judges.html">The IOCCC Judges</a>
      <a href="../../contact.html">Contacting the IOCCC</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="#top">Jump to top</a>
    </div>

<!-- END: this line ends content from: inc/sidenav.default.html -->
<!-- START: this line starts content from: inc/end-leftcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/begin-rightcolumn.default.html -->

  <div class="rightcolumn">

<!-- END: this line ends content from: inc/begin-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/before-content.default.html -->

    <a name="content"></a>

<!-- END: this line ends content from: inc/before-content.default.html -->
<!-- START: this line starts content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-author.sh -->

<h2 id="author"><a name="author"></a>Author:</h2>
<ul>
<li>Name: <a href="../../authors.html#Marcin_Ciura">Marcin Ciura</a><br>
Location: <a href="../../location.html#PL">PL</a> <br><br></li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-author.sh -->

<!-- END: this line ends content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->

<h2 id="to-build">To build:</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span></span></code></pre></div>
<p>There is an alternate version that lacks a useful bug fix. See <a
href="#alternate-code">Alternate code</a> and the author’s remarks (<a
href="#remarks">remarks section</a>) below for more details.</p>
<h2 id="to-use">To use:</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./prog</span> <span class="op">&lt;</span> text</span></code></pre></div>
<h2 id="try">Try:</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./try.sh</span></span></code></pre></div>
<h2 id="alternate-code">Alternate code:</h2>
<p>An alternate version of this entry, <a
href="prog.alt.c">prog.alt.c</a>, is provided. As mentioned in the
author’s <a href="#remarks">remarks</a>, the alternate version lacks a
useful bug fix.</p>
<h3 id="alternate-build">Alternate build:</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> alt</span></code></pre></div>
<h3 id="alternate-use">Alternate use:</h3>
<p>Use <code>prog.alt</code> as you would <code>prog</code> above.</p>
<h3 id="alternate-try">Alternate try:</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./try.alt.sh</span></span></code></pre></div>
<p>Do you spot the fix by running both <a href="try.sh">try.sh</a> and
<a href="try.alt.sh">try.alt.sh</a>?</p>
<h2 id="judges-remarks">Judges’ remarks:</h2>
<p>This text was processed by <code>prog</code>. You may get confused.
We’re not really sure: <a href="prog.c">prog.c</a> wasn’t commented. Who
has been thoroughly puzzled by <code>prog</code>? Also how obfuscated is
<code>prog</code>? Having been written in C, how large of a vocabulary
has it?</p>
<h2 id="authors-remarks">Author’s remarks:</h2>
<h3 id="the-program">The Program:</h3>
<p>“The Elements of Style” by Prof. William Strunk, Jr. and E. B. White
is well known for its dislike of the passive voice. Direct, vigorous,
active constructions were instead recommended by the authors. The
development of this program has been driven by this tenet.</p>
<p>Only passive sentences from the standard input are output. The
offending part(s) of each sentence will be highlighted. Several kinds of
passive constructions are recognized:</p>
<ul>
<li>Plain passive voice. Foo was bazzed by bar.</li>
<li>Passive voice with “get”. I got almost quuxed.</li>
<li>Contractions. I’m not really quuxed: foo wasn’t bazzed.</li>
<li>Questions. Who has been quuxed? Was foo indeed bazzed? How was it
bazzed?</li>
<li>Clause-initial inversion. Also bazzed is bar.</li>
</ul>
<p>Sentences are never broken by periods that follow abbreviations and
initials. Both regular and irregular past participles are properly dealt
with. Note that some words are red herrings: even though their ending is
<code>-ed</code>, they are not past participles.</p>
<h3 id="the-big-string">The Big String:</h3>
<p>Here is the purpose of every byte inside the <code>c[]</code>
string:</p>
<ul>
<li><code>0-9</code>: highlighting passive constructions in the
output.</li>
<li><code>10-50</code>: classifying characters - called by
<code>V(4)</code>.</li>
<li><code>52</code>: outputting the newline character.</li>
<li><code>51-187</code>: tokenizing text and detecting passive
constructions - two type A state machines, called by <code>V(2)</code>
and <code>V(3)</code>.</li>
<li><code>186-2786</code>: determining word categories (past
participles, present simple and past simple forms of “to be”, other
forms of “to be”, adverbs, wh-words, and other words) and recognizing
abbreviations - two type B state machines, called by <code>V(808)</code>
and <code>V(205)</code>.</li>
</ul>
<h3 id="the-state-machines">The State Machines:</h3>
<p>I heard you don’t like state machines so I put a state machine in
your state machine so you can reject this entry while you reject this
entry.</p>
<p>Both types of state machines in the program are Mealy machines: we
can think of their transitions as triples
(<code>transition_label</code>, <code>next_state</code>,
<code>output</code>).</p>
<h3 id="type-a">Type A:</h3>
<p>A state of type A state machine consists of eight transitions whose
representations occupy consecutive bytes. The byte
<code>c[3 + 8*state + transition_label]</code> contains
<code>(unsigned char)(30 + 5*next_state + output)</code>.</p>
<p>The <code>transition_label</code> is either one of character
classes:</p>
<ul>
<li><code>nil</code> = 0,</li>
<li><code>space</code> = 1,</li>
<li><code>new_line</code> = 2,</li>
<li><code>uppercase</code> = 3,</li>
<li><code>lowercase</code> = 4,</li>
<li><code>period</code> = 5,</li>
<li><code>bang_question</code> = 6,</li>
<li><code>punctuation</code> = 7,</li>
</ul>
<p>or one of word classes:</p>
<ul>
<li><code>adverb</code> = 0,</li>
<li><code>other</code> = 2,</li>
<li><code>past_participle</code> = 3,</li>
<li><code>to_be</code> = 4,</li>
<li><code>are_were</code> = 5,</li>
<li><code>wh_word</code> = 6 (cf. the <code>output</code> of type B
state machines).</li>
</ul>
<p>The <code>output</code> is either one of:</p>
<ul>
<li><code>end_of_text</code> = 0,</li>
<li><code>sentence_start</code> = 1,</li>
<li><code>sentence_end</code> = 2,</li>
<li><code>token_end</code> = 3,</li>
<li><code>ignore</code> = 4,</li>
</ul>
<p>or one of</p>
<ul>
<li><code>passive_construction_start</code> = 1,</li>
<li><code>ignore</code> = 2,</li>
<li><code>passive_construction_end</code> = 3.</li>
</ul>
<p>Type A state machines run continuously. Their state is kept in
<code>k[2]</code> and <code>k[3]</code>.</p>
<p>Below are sample steps of scanning a sequence of characters with
classes <code>uppercase</code>, <code>lowercase</code>,
<code>period</code>, <code>space</code>, and <code>uppercase</code>.</p>
<ul>
<li><code>state</code> = 7, <code>transition_label</code> = 3
(<code>uppercase</code>), <code>output</code> =
<code>sentence_start</code></li>
<li><code>state</code> = 14, <code>transition_label</code> = 4
(<code>lowercase</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 15, <code>transition_label</code> = 5
(<code>period</code>), <code>output</code> = <code>token_end</code></li>
<li><code>state</code> = 13, <code>transition_label</code> = 1
(<code>space</code>), <code>output</code> = <code>token_end</code></li>
<li><code>state</code> = 18, <code>transition_label</code> = 3
(<code>uppercase</code>), <code>output</code> =
<code>sentence_end</code></li>
</ul>
<p>And here are sample steps of scanning tokens with classes
<code>to_be</code>, <code>adverb</code>,
<code>past_participle</code>.</p>
<ul>
<li><code>state</code> = 8, <code>transition_label</code> = 4
(<code>to_be</code>), <code>output</code> =
<code>passive_construction_start</code></li>
<li><code>state</code> = 22, <code>transition_label</code> = 0
(<code>adverb</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 22, <code>transition_label</code> = 3
(<code>past_participle</code>), <code>output</code> =
<code>passive_construction_end</code></li>
</ul>
<h3 id="type-b">Type B:</h3>
<p>Type B state machines are built by a variant of the algorithm
described in the paper <a href="lexicon.pdf">How to squeeze a lexicon
(PDF)</a>. Their states are represented as interlaced sparse arrays of
transitions.</p>
<p>The <code>transition_label</code> is one of:</p>
<ul>
<li><code>word_start</code> = 0,</li>
<li><code>period_or_apostrophe</code> = 1,</li>
<li><code>a_z_letter</code> = 2..27.</li>
</ul>
<p>The <code>output</code> is either one of word classes:</p>
<ul>
<li><code>adverb</code> = 0,</li>
<li><code>ignore</code> = 1,</li>
<li><code>other</code> = 2,</li>
<li><code>past_participle</code> = 3,</li>
<li><code>to_be</code> = 4,</li>
<li><code>are_were</code> = 5,</li>
<li><code>wh_word</code> = 6,</li>
</ul>
<p>or</p>
<ul>
<li><code>ignore</code> = 1,</li>
<li><code>abbreviation</code> = 2.</li>
</ul>
<p>The byte <code>c[186 + (state + transition_label)]</code> =
<code>(unsigned char)(2 + transition_label + 28 * output)</code>.</p>
<p>The byte <code>c[836 + 2*(state + transition_label)]</code> =</p>
<ul>
<li><code>' '</code> when <code>next_state / 376 == 0</code>,</li>
<li><code>';'</code> when <code>next_state / 376 == 1</code>.</li>
</ul>
<p>The byte <code>c[837 + 2*(state + transition_label)]</code> =</p>
<ul>
<li><code>' '</code> when <code>next_state / 94 % 4 == 0</code>,</li>
<li><code>';'</code> when <code>next_state / 94 % 4 == 1</code>,</li>
<li><code>'{'</code> when <code>next_state / 94 % 4 == 2</code>,</li>
<li><code>'}'</code> when <code>next_state / 94 % 4 == 3</code>.</li>
</ul>
<p>The byte <code>c[2136 + (state + transition_label)]</code> =
<code>(unsigned char)(32 + next_state % 94)</code>.</p>
<p>A type B state machine starts in a given <code>state</code> with
<code>output</code> set to <code>ignore</code>. It scans a word
backwards, converting character by character to
<code>transition_label</code>. When it meets <code>word_start</code>, it
returns, leaving the most recently stored <code>output</code> in
<code>v</code>.</p>
<p>It also returns when
<code>c[186 + (state + transition_label)] != (unsigned char)(2 + transition_label + 28 * output)</code>,
i.e. when the <code>transition_label</code> in the byte mismatches the
<code>transition_label</code> used to compute the index. Otherwise, if
the <code>output</code> in this byte differs from <code>ignore</code>,
the state machine stores it in <code>v</code>. Regardless of the value
of the <code>output</code>, it also assigns <code>next_state</code> to
<code>state</code> and proceeds to scan the previous character. The
state machine that determines the word class is set up so that it never
returns <code>ignore</code>.</p>
<p>Below are sample steps of scanning the word “chiefly”.</p>
<ul>
<li><code>state</code> = 623, <code>transition_label</code> = 26
(<code>'y'</code>), <code>output</code> = <code>other</code></li>
<li><code>state</code> = 602, <code>transition_label</code> = 13
(<code>'l'</code>), <code>output</code> = <code>adverb</code></li>
<li><code>state</code> = 594, <code>transition_label</code> = 7
(<code>'f'</code>), <code>output</code> = <code>other</code></li>
<li><code>state</code> = 549, <code>transition_label</code> = 6
(<code>'e'</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 543, <code>transition_label</code> = 10
(<code>'i'</code>), <code>output</code> = <code>adverb</code></li>
<li><code>state</code> = 0, <code>transition_label</code> = 9
(<code>'h'</code>) mismatches the value stored in the byte. Return
<code>adverb</code>.</li>
</ul>
<p>And here are sample steps of scanning the string “i.e.”:</p>
<ul>
<li><code>state</code> = 19, <code>transition_label</code> = 1
(<code>'.'</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 24, <code>transition_label</code> = 6
(<code>'e'</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 3, <code>transition_label</code> = 1
(<code>'.'</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 2, <code>transition_label</code> = 10
(<code>'i'</code>), <code>output</code> = <code>ignore</code></li>
<li><code>state</code> = 1, <code>transition_label</code> = 0
(<code>'\0'</code>), <code>output</code> = <code>abbreviation</code>.
Return <code>abbreviation</code>.</li>
</ul>
<h3 id="remarks">Remarks:</h3>
<p>The judges found a bug in the handling of contractions: <a
href="prog.alt.c">prog.alt.c</a> outputs “foo wasn’<strong>[t
bazzed]</strong>”. I fixed the bug in <a href="prog.c">prog.c</a>,
making it output “foo <strong>[wasn’t bazzed]</strong>” instead, and
took the liberty to merge one statement into a <code>for</code> loop
inside its <code>main()</code> function.</p>
<p>The program uses a 9,437,187-byte buffer so it probably will not run
on 16-bit and smaller machines without changing the size of array
<code>C[]</code> and the expression <code>9&lt;&lt;20</code> inside the
call to <code>read(2)</code>.</p>
<p>I have tested it on:</p>
<ul>
<li>Linux with gcc version 5.4.0 20160609,</li>
<li>Linux with clang version 3.4-1ubuntu3,</li>
<li>OS/X with Apple LLVM version 6.0 (clang-600.0.57).</li>
</ul>
<p>For a clean compile under C89 and C90, add
<code>-Woverlength-strings</code> to <code>CSILENCE</code>.</p>
<h2 id="copyright-and-cc-by-sa-4.0-license">Copyright and CC BY-SA 4.0
License:</h2>
<p>This file is Copyright (c) 2023 by Landon Curt Noll. All Rights
Reserved. You are free to share and adapt this file under the terms of
this license:</p>
<pre><code>Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)</code></pre>
<p>For more information, see:
https://creativecommons.org/licenses/by-sa/4.0/</p>

<!-- END: this line ends content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-inventory.sh -->

<h1 id="inventory-for-2018ciura"><a name="inventory"></a>Inventory for
2018/ciura</h1>
<h2 id="primary-files">Primary files</h2>
<ul>
<li><a href="index.html">index.html</a> - entry home page</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/prog.c">prog.c</a>
- winning source</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/Makefile">Makefile</a>
- entry Makefile</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/prog.alt.c">prog.alt.c</a>
- alternative source</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/prog.orig.c">prog.orig.c</a>
- original source</li>
<li><a href="lexicon.pdf">lexicon.pdf</a> - How to squeeze a lexicon
paper</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/try.alt.sh">try.alt.sh</a>
- how to run alternate code</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/try.sh">try.sh</a>
- how to run</li>
<li><a href="2018_ciura.tar.bz2">2018_ciura.tar.bz2</a> - download
winning source</li>
</ul>
<h2 id="secondary-files">Secondary files</h2>
<ul>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/.entry.json">.entry.json</a>
- description of entry in JSON</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/.gitignore">.gitignore</a>
- list of files that should not be committed under git</li>
<li><a href=".path">.path</a> - directory path from top directory</li>
<li><a
href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/2018/ciura/README.md">README.md</a>
- markdown source for index.html</li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-inventory.sh -->

<!-- END: this line ends content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->
<!-- START: this line starts content from: inc/after-content.default.html -->

<!-- END: this line ends content from: inc/after-content.default.html -->
<!-- START: this line starts content from: inc/end-rightcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/end-row.default.html -->

</div>

<!-- END: this line ends content from: inc/end-row.default.html -->
<!-- START: this line starts content from: inc/footer.default.html -->

<div class="footer">
  <hr>
  <h2>Coda</h2>
  <p><a href="https://validator.w3.org/nu/?doc=https%3A%2F%2Fioccc-src.github.io%2Ftemp-test-ioccc%2F2018%2Fciura%2Findex.html">Nu HTML check this web page</a></p>
  <p><a href="#top">Jump to top</a> <a href="#content">Jump to Content</a> <a href="#inventory">Jump to Inventory</a></p>
</div>

<!-- END: this line ends content from: inc/footer.default.html -->
<!-- START: this line starts content from: inc/bottom.default.html -->

</body>
</html>

<!-- END: this line ends content from: inc/bottom.default.html -->
