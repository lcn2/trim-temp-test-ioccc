<!doctype html public "-//W3C//DTD HTML 4.0 Transitional //EN">
<html>
<head>
  <meta name="GENERATOR" content="mkd2html 2.2.2">
  <meta http-equiv="Content-Type"
        content="text/html; charset=utf-8">  <link rel="stylesheet"
        type="text/css"
        href="../hint.css" />
  <title></title>
  <title>Best utility</title>
</head>
<body>
<CENTER>
    <IMG SRC="/png/ioccc.png" ALT="IOCCC" height=78 width=267>
    <P><FONT size="6"><I>The International Obfuscated C Code Contest</I></FONT></P>
    <div id="bar">
    <ul>
        <li><a href="../index.html">About the 27th IOCCC</a></li>
        <li><a href="../whowon.html">27th IOCCC Winners</a></li>
        <li><a href="/index.html">IOCCC home</a></li>
        <li><a href="/winners.html">List of All Winners</a></li>
        <li><a href="/judges.html">The Judges</a></li>
    </ul>
    </div>
    <P><FONT size="6"><B>A 27<sup>th</sup> IOCCC Winner</B></FONT></P>
</CENTER>


<h1>Best utility</h1>

<p>Ilya Kurdyukov<br/>
<a href="https://github.com/ilyakurdyukov">https://github.com/ilyakurdyukov</a><br/>
Twitter: @ilyakurdyukov</p>

<p>The code for this entry can be found in <a href="prog.c">prog.c</a></p>

<h2>Judges' comments:</h2>

<h3>To use:</h3>

<pre><code>make
./prog
</code></pre>

<h3>Try:</h3>

<pre><code># Obfuscated IOCCC
echo IOCCC | ./prog

./prog &lt; prog.x86.asm

./prog &lt; prog.x86_64.asm
</code></pre>

<h3>Selected Judges Remarks:</h3>

<p>This hash of a C code makes a hash out of input.
Do you understand how?
You should get a-round-to-it figuring it out!</p>

<h2>Author&rsquo;s comments:</h2>

<h3>MD5 with integers</h3>

<p>Just a tiny MD5 checksum utility. Prints hash string of data from stdin.
Work same as <code>(openssl md5 | cut -d' ' -f2)</code> command.</p>

<h3>My objectives</h3>

<ol>
<li>reduce code size as much as possible</li>
<li>avoid warnings from GCC/CLANG <code>-Wall -Wextra -pedantic</code></li>
<li>portable (regardless of register size and endianness)</li>
<li>fit code in a round shape</li>
<li>no macro defines</li>
<li>no floating-point arithmetics</li>
</ol>


<h3>Notes</h3>

<p>The main difficulty of making MD5 code smaller is a 64x4 bytes long table with constants. Which will take more than 512 bytes in text hex encoding. This table is a results of a sine function, so can be generated dynamically, but merging floating-point arithmetics with precise integer calculations is not a great idea, because can make portability issues.</p>

<p>Attempts to satisfy CLANG <code>-Weverything</code> will ruin comma magic, that is so great for obfuscation, so I don&rsquo;t want to care about that.</p>

<p>Probably, should work correctly on any machines, but I have nothing exotic (like BE or not 32/64) to try it.</p>

<p>Added a macro hack to make stdin work in binary mode under Windows (tested under mingw64), otherwise the hashes can be incorrect.</p>

<h3>Bonus</h3>

<ul>
<li><p><code>prog.extra.c</code> the same with the sine function (so smaller), and in different shapes.</p></li>
<li><p><code>prog.x86_64.asm</code> contains same program, but written on assembly for x86_64 Linux, for the sake of less executable size. Which is 500 bytes long (where 120 is for ELF headers) after compilation. Algorithm details is slightly differ (like constants packing), just to make smaller binary code. It&rsquo;s interesting to compare density of binary code and obfuscated C.</p></li>
<li><p><code>prog.x86.asm</code> and for x86, although the headers are smaller, but the binary code is larger due to fewer registers and lack of 64-bit multiply.</p></li>
</ul>

<BR>
<HR>
<TABLE><TR>
<TD><a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="/png/by-sa-3.0-88x31.png" /></a></TD>
<TD><P>&copy; Copyright 1984-2020,
<A HREF="/judges.html">Leo Broukhis, Simon Cooper, Landon Curt Noll</A>
- All rights reserved<BR>
This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</P></TD>
<TD>&nbsp;<!--<a href="https://validator.w3.org/check?uri=referer"><img src="https://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01 Transitional" height="31" width="88"></a>--></TD>
</TR></TABLE>
</body>
</html>
