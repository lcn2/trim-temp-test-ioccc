<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- START: two lines up starts content from: inc/top.default.html -->

<!-- END: this line ends content from: inc/top.default.html -->
<!-- START: this line starts content from: inc/head.default.html -->

<head>
<link rel="stylesheet" href="../../ioccc.css">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>1998/schweikh2 - Most Erratic Behavior</title>
<link rel="icon" type="image/x-icon" href="../../favicon.ico">
<meta name="description" content="1998 IOCCC entry schweikh2 - Most Erratic Behavior">
<meta name="keywords" content="IOCCC, 1998, IOCCC 1998, IOCCC entry, schweikh2, Most Erratic Behavior">
</head>

<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!! DO NOT MODIFY THIS FILE - This file is generated by a tool !!! -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->

<!-- END: this line ends content from: inc/head.default.html -->

<!-- -->
<!-- This web page was formed via the tool: bin/readme2index.sh -->
<!-- The content of main section of this web page came from: 1998/schweikh2/README.md -->
<!-- -->

<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<!-- !!! Do not modify this web page, instead modify the file: 1998/schweikh2/README.md !!! -->
<!-- !!! Do not modify this web page, instead modify the file: 1998/schweikh2/README.md !!! -->
<!-- !!! Do not modify this web page, instead modify the file: 1998/schweikh2/README.md !!! -->
<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->

<!-- Markdown content was converted into HTML via the tool: bin/md2html.sh -->

<!-- START: this line starts content from: inc/body.default.html -->

<body>

<!-- END: this line ends content from: inc/body.default.html -->
<!-- START: this line starts content from: inc/header.default.html -->

<div class="header">
  <img src="../../png/ioccc.png" alt="IOCCC image by Matt Zucker" width=300 height=110>
  <h1>The International Obfuscated C Code Contest</h1>
  <h2>1998/schweikh2 - Most Erratic Behavior</h2>
</div>

<!-- END: this line ends content from: inc/header.default.html -->
<!-- START: this line starts content from: inc/topnav.mid.html -->

<div class="topnav">
  <a class="Left" href="../schweikh1/index.html">&larr; schweikh1</a>
  <a class="Left" href="../index.html">&uarr; 1998 &uarr;</a>
  <a class="Left" href="../schweikh3/index.html">schweikh3 &rarr;</a>
  <a class="Right" href="https://github.com/ioccc-src/temp-test-ioccc/1998/schweikh2/schweikh2.c">C code</a>
  <a class="Right" href="https://github.com/ioccc-src/temp-test-ioccc/1998/schweikh2/Makefile">Makefile</a>
  <a class="Right" href="#inventory">Inventory</a>
</div>

<!-- END: this line ends content from: inc/topnav.mid.html -->
<!-- START: this line starts content from: inc/begin-row.default.html -->

<div class="row">

<!-- END: this line ends content from: inc/begin-row.default.html -->
<!-- START: this line starts content from: inc/begin-leftcolumn.default.html -->

  <div class="leftcolumn">

<!-- END: this line ends content from: inc/begin-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/sidenav.default.html -->

    <div class="sidenav">
      <a href="#content">Jump to contents</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../index.html">IOCCC Home</a>
      <a href="../../years.html">Winning Entries</a>
      <a href="../../authors.html">People who have won</a>
      <a href="../../location.html">Location of authors</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../news.html">IOCCC News</a>
      <a href="../../status.html">Contest status</a>
      <a href="../../faq.html#submit">How to enter the IOCCC</a>
      <a href="../../faq.html">FAQ</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../bugs.html">Bugs &amp; (mis)features</a>
      <a href="../../faq.html#fix_an_entry">Fixing IOCCC entries</a>
      <a href="../../faq.html#fix_web_site">Fixing the web site</a>
      <a href="../../faq.html#fix_author">Fixing author info</a>
      <a href="../../thanks-for-help.html">Thanks for the help</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="../../judges.html">The IOCCC Judges</a>
      <a href="../../contact.html">Contacting the IOCCC</a>
    </div>
    <hr>
    <div class="sidenav">
      <a href="#top">Jump to top</a>
    </div>

<!-- END: this line ends content from: inc/sidenav.default.html -->
<!-- START: this line starts content from: inc/end-leftcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-leftcolumn.default.html -->
<!-- START: this line starts content from: inc/begin-rightcolumn.default.html -->

  <div class="rightcolumn">

<!-- END: this line ends content from: inc/begin-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/before-content.default.html -->

    <a name="content"></a>

<!-- END: this line ends content from: inc/before-content.default.html -->
<!-- START: this line starts content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-author.sh -->

<h2 id="author"><a name="author"></a>Author:</h2>
<ul>
<li>Name: <a href="../../authors.html#Jens_Schweikhardt">Jens Schweikhardt</a><br>
Location: <a href="../../location.html#DE">DE</a> - <em>Federal Republic of Germany</em> (<em>Germany</em>)</li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-author.sh -->

<!-- END: this line ends content for HTML phase 20 by: bin/output-index-author.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->

<h2 id="to-build">To build:</h2>
<pre class="&lt;!---sh--&gt;"><code>    make all</code></pre>
<h2 id="to-use">To use:</h2>
<pre class="&lt;!---sh--&gt;"><code>    ./yarng</code></pre>
<p>or</p>
<pre class="&lt;!---sh--&gt;"><code>    ./yarng integer_number</code></pre>
<h2 id="try">Try:</h2>
<pre class="&lt;!---sh--&gt;"><code>    ./try.sh

    ./yarng
    # watch what it does</code></pre>
<p>What is the difference between what is in the script and running <code>yarng</code> without
an arg?</p>
<h2 id="judges-remarks">Judges’ remarks:</h2>
<p>Run the program with a small argument, like 5 or 10, several times. Are the
results different? Why?</p>
<h3 id="historical-remarks">Historical remarks:</h3>
<p>At the time of judging, some non-gcc compilers that were not fully ANSI standard
did not compile this entry correctly. Also at that time, some gcc and egcs
implementations ran into a problem when building the entry. Doing:</p>
<pre class="&lt;!---sh--&gt;"><code>    make schweikh2</code></pre>
<p>often produced an error of the form:</p>
<pre class="&lt;!---sh--&gt;"><code>    gcc -ansi schweikh2.alt.c -o schweikh2.alt
    as: Error: cca00NzV.s, line 58: Missing &quot; at end of string
         &quot;
    as: Error: cca00NzV.s, line 58: malformed statement
    *** Error code 1 (bu21)</code></pre>
<p>because the line:</p>
<pre class="&lt;!---c--&gt;"><code>    #line 10 ONE(O(1,1,2,6,0,6))</code></pre>
<p>turned into the line:</p>
<pre class="&lt;!---c--&gt;"><code>    # 9 &quot;01\012&quot;</code></pre>
<p>(note, though, how that line is on line 11) which caused gcc to give to the
assembler the following two lines:</p>
<pre class="&lt;!---asm--&gt;"><code>    .stabs &quot;schweikh2.c
    &quot;,132,0,0,Ltext1</code></pre>
<p>and the lone <code>"</code> after the <code>#.file</code> line resulted in an assembly syntax error.</p>
<p>In some cases one had to compile using <code>gcc -g</code>:</p>
<pre class="&lt;!---sh--&gt;"><code>    make schweikh2 CFLAGS=-g</code></pre>
<p>to trigger this error.</p>
<p>With the proper text beyond the <code>\012</code>, it was even possible to have all kinds
of fun adding inline assembly via <code>#line</code> directives. :-)</p>
<h4 id="for-extra-fun-and-credit">For extra fun and credit:</h4>
<p>If your compiler had this bug, you could transform the line in the C program to
inject assembly instructions in such a way that the program would compile.</p>
<p>If you were able to do that, you could have tried adding assembly instructions
so that it will compile, execute and do something interesting (or uninteresting,
for that matter :-) ).</p>
<p>If you succeeded in doing that (especially on FreeBSD, Linux or SunOS/Solaris),
you could have emailed the author for a free pat on the back (and maybe you
still can :-) ).</p>
<p>Because of this bug, the code was changed to be instead:</p>
<pre class="&lt;!---c--&gt;"><code>    #line 10 &quot;01\015&quot;</code></pre>
<p>However in 2023 it was observed that <em>it is gcc</em> (at least some versions?) that
has a problem with the compilation of the <em>modified</em> program, giving an internal
compiler error:</p>
<pre><code>    :10:16: warning: type defaults to &#39;int&#39; in declaration of &#39;zero&#39; [-Wimplicit-int]
    : In function &#39;main&#39;:
    :12:1: warning: missing terminating &quot; character
    :12:19: internal compiler error: invalid built-in macro &quot;__FILE__&quot;</code></pre>
<p>so the line:</p>
<pre class="&lt;!---c--&gt;"><code>    #line 10 &quot;01\015&quot;</code></pre>
<p>was changed to:</p>
<pre class="&lt;!---c--&gt;"><code>    #line 10 ONE(O(1,1,2,6,0,6))</code></pre>
<p>and now it works with both clang and gcc.</p>
<h2 id="authors-remarks">Author’s remarks:</h2>
<h3 id="what-this-program-does">What this program does</h3>
<p>My entry is a <code>yarng</code>, which stands for, you guessed it, yet another
random number generator, and is pronounced ‘yawn’ due to its
incredible speed. Seriously, it exploits the randomness of quantum
mechanical events that build up the hardware as well as some other
non-deterministic factors. Here’s how it works:</p>
<ol type="1">
<li>an alarm is scheduled to be delivered in a second</li>
<li>an infinite loop is entered that just increments a counter</li>
<li>on delivery of the alarm signal, the counter’s LSB is printed.</li>
<li>while some other counter is not zero, go to step (1)</li>
<li>exit</li>
</ol>
<p>The <code>yarng</code> therefore produces output at a rate of 1 baud. The number of
bits may be specified by an argument and defaults either to <code>UINT_MAX</code>
(least likely) or <code>UINT_MAX+1</code> (most likely). Extra credit: why the
different values? How long would you need for an empirical test?</p>
<p>For example:</p>
<pre class="&lt;!---sh--&gt;"><code>    $ ./yarng 32
    10111001010101110110010101001111
    $ ./yarng 5
    10011</code></pre>
<h3 id="why-i-think-this-is-obfuscated">Why I think this is obfuscated</h3>
<ul>
<li><p>Ever seen a ‘do for … while’ loop?</p></li>
<li><p>I avoided <code>int</code> like the plague. Instead I used storage class specifiers
(<code>register</code>, <code>auto</code>) to get implicit <code>int</code>. The Standard allows implicit <code>int</code> even in
casts as you can see in <code>(void(*)(register))main</code>. Where implicit <code>int</code> is
impossible, like in the <code>int main</code> declaration I have <code>int</code> split across two
lines. All indent programs I use insert space at the beginning of the
continuation line and thereby introduce a syntax error.</p></li>
<li><p><code>main()</code> (ab)used as a signal handler. Shocking. Yeah, this leads to undefined
behaviour. I have yet to see a system where it does not work. If it doesn’t work
for you, I’d appreciate if you mail me about it. Uh-oh, Schweikh did it,
uttered “Works for me”. Don’t quote me on that!</p></li>
<li><p>Even if you know how the program works, you just can’t predict the output.</p></li>
<li><p>Chained use of token pasting operators <code>##</code> with shuffled arguments.</p></li>
<li><p>So you think you can’t assign to <code>__LINE__</code> and <code>__FILE__</code>? Not so. The <code>#line</code>
preprocessor directive does the trick. But saying <code>#line 10 "01\n"</code> is a little
lame and I came up with <code>??=line 10 ONE(O(1,1,2,6,0,6))</code>.</p></li>
<li><p><code>__LINE__</code> is used as the signal number argument to <code>signal()</code>. If indenting or
other editing changes the number of lines the program is likely to be killed
after one second… Thanks to POSIX for specifying <code>SIGALRM</code> as <code>14</code>. You’re SOL if
your system does not conform. Get a real OS.</p></li>
<li><p>All strings (or characters) needed are crammed into <code>__FILE__</code> using octal
notation and then extracted using pointer + offset notation.</p></li>
<li><p>Use of a <code>#</code> (null) preprocessor directive (hidden as a <code>%:</code> digraph) Delete
this line and prepare for a core dump.</p></li>
<li><p>Identifiers reused with different capitalization: <code>one</code>, <code>One</code>, <code>ONE</code>, <code>zero</code>,
<code>Zero</code>. <code>ONE</code> is particularly nasty because it appears as a macro taking an arg
and as a plain identifier in <code>main</code>’s parameters. The rule is that whenever
<code>ONE</code> is followed by <code>(</code> it must be the macro.</p></li>
<li><p>A quote from Kernighan and Plauger, <em>The Elements of Programming Style</em>, 2nd
Ed., page 21: <code>"A useful way to decide if some piece of code is clear or not is the 'telephone test.' If someone could understand your code when read aloud over the telephone, it's clear enough. If not then it needs rewriting."</code> Now try
the telephone test for ‘one = zero = atoi (ONE[zero-1])’.</p></li>
<li><p>Don’t you love the aesthetics of symmetry: <code>write (1, 1+__FILE__+1, 1)</code>
(telephone test this as well; is it 1, One, ONE, one? Maybe won?).</p></li>
</ul>
<h3 id="where-does-the-randomness-come-from">Where does the randomness come from?</h3>
<p>Each bit obviously depends on the number of times the loop body is
executed between two calls of the signal handler. But what determines
this number?</p>
<ul>
<li>The accuracy of the clock driving the CPU.</li>
<li>The accuracy of the clock driving the timer responsible for alarm signals.</li>
<li>On multitasking OSes: The total time the process is scheduled to run between
successive invocations of the signal handler.</li>
</ul>
<p>How about the randomness of the <code>yarng</code>? To measure these properties I
counted the number of bit sequences and compared them to what I would
expect from a generator with uniform distribution (all sequences
equally likely to occur).</p>
<p>It is interesting to note that <code>yarng</code>’s maximum deviations are less
than or equal to <code>rand(3)</code>’s. Randomness however tends to degrade under
high load averages on my system (Linux). This could be avoided by
allowing the process one second of execution time instead of wall
clock time (using the <code>SIGVTALRM</code> sent by the virtual timer
instead of <code>SIGALRM</code>).</p>
<p>I’m not surprised. <code>Yarng</code> in the end depends on fluctuations of the
electrical field and the heat distribution in the oscillators, the
implementation and state of the scheduling algorithm, the system
load, number and temporal distribution of asynchronous events and
last but not least the phase of the moon. God <em>does</em> play dice.
Type <code>yarng</code> and watch Him roll.</p>
<!--

    Copyright © 1984-2024 by Landon Curt Noll. All Rights Reserved.

    You are free to share and adapt this file under the terms of this license:

        Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)

    For more information, see:

        https://creativecommons.org/licenses/by-sa/4.0/

-->

<!-- END: this line ends content for HTML phase 21 by: bin/pandoc-wrapper.sh via bin/md2html.sh -->
<!-- START: this line starts content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->

<!-- START: this line starts content generated by: bin/output-index-inventory.sh -->

<h1 id="inventory-for-1998schweikh2"><a name="inventory"></a>Inventory for 1998/schweikh2</h1>
<p><a href="#top">Jump to top</a></p>
<h2 id="primary-files">Primary files</h2>
<ul>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/schweikh2.c">schweikh2.c</a> - entry source</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/Makefile">Makefile</a> - entry Makefile</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/schweikh2.orig.c">schweikh2.orig.c</a> - original source</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/try.sh">try.sh</a> - how to run</li>
<li><a href="1998_schweikh2.tar.bz2">1998_schweikh2.tar.bz2</a> - download entry</li>
</ul>
<h2 id="secondary-files">Secondary files</h2>
<ul>
<li><a href="index.html">index.html</a> - this web page</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/README.md">README.md</a> - markdown source for index.html</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/.entry.json">.entry.json</a> - description of entry in JSON</li>
<li><a href="https://github.com/ioccc-src/temp-test-ioccc/blob/master/1998/schweikh2/.gitignore">.gitignore</a> - list of files that should not be committed under git</li>
<li><a href=".path">.path</a> - directory path from top directory</li>
</ul>

<!-- END: next line ends content generated by: bin/output-index-inventory.sh -->

<!-- END: this line ends content for HTML phase 22 by: bin/output-index-inventory.sh via bin/md2html.sh -->
<!-- START: this line starts content from: inc/after-content.default.html -->

<!-- END: this line ends content from: inc/after-content.default.html -->
<!-- START: this line starts content from: inc/end-rightcolumn.default.html -->

  </div>

<!-- END: this line ends content from: inc/end-rightcolumn.default.html -->
<!-- START: this line starts content from: inc/end-row.default.html -->

</div>

<!-- END: this line ends content from: inc/end-row.default.html -->
<!-- START: this line starts content from: inc/footer.default.html -->

<!--

    Copyright © 1984-2024 by Landon Curt Noll. All Rights Reserved.

    You are free to share and adapt this file under the terms of this license:

	Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)

    For more information, see:

	https://creativecommons.org/licenses/by-sa/4.0/

-->

<div class="footer">
  <h2><a name="copyright"></a>Copyright and CC BY-SA 4.0 License</h2>
  <p>All IOCCC content including this file and web page are:</p>
  <b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright &copy; 1984-2024 by Landon Curt Noll. <a href="https://creativecommons.org/faq/#what-does-some-rights-reserved-mean">Some Rights Reserved</a>.</b>
  <p>This work is licensed by Landon Curt Noll under:</p>
  <p xmlns:cc="http://creativecommons.org/ns#" ><b><a href="https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1"
  target="_blank" rel="license noopener noreferrer" style="display:inline-block;">&nbsp;&nbsp;&nbsp;&nbsp;CC BY-SA 4.0
  <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
  src="../..//svg/cc.svg"
  alt="cc inside circle symbol">
  <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
  src="../..//svg/by.svg"
  alt="person inside circle symbol">
  <img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;"
  src="../..//svg/sa.svg"
  alt="arrow looping back on itself inside circle symbol">
  </a></b></p>
  <p>The <b>CC BY-SA 4.0 LEGAL CODE</b> for this license is found under:</p>
  <p>&nbsp;&nbsp;&nbsp;<b><a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode.en">
  https://creativecommons.org/licenses/by-sa/4.0/legalcode.en</a></b></p>
  <p>You should <b>carefully review</b> all of the terms and conditions of the
  <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode.en">actual license</a>
  before using the licensed material.</p>
  <p>You may wish to review the <b><a href="../../license.html">highlights of some of the key
  features and terms</a></b> of the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode.en">actual license</a>.</p>
  <h2>Coda</h2>
  <p><a href="https://validator.w3.org/nu/?doc=https%3A%2F%2Fioccc-src.github.io%2Ftemp-test-ioccc%2F1998%2Fschweikh2%2Findex.html">Nu HTML check this web page</a></p>
  <p><a href="#top">Jump to top</a> <a href="#content">Jump to Content</a> <a href="#inventory">Jump to Inventory</a></p>
</div>

<!-- END: this line ends content from: inc/footer.default.html -->
<!-- START: this line starts content from: inc/bottom.default.html -->

</body>
</html>

<!-- END: this line ends content from: inc/bottom.default.html -->
